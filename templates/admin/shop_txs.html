{% extends "base.html" %}
{% block content %}
<h3>{{ shop.name }} â€” Balans: 
  <span class="badge {% if balance>0 %}bg-warning text-dark{% elif balance<0 %}bg-success{% else %}bg-secondary{% endif %}">
    {{ '%.0f'|format(balance) }}
  </span>
</h3>

<div class="row g-3 mb-4">
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">Qarzga tovar summasi (sale)</div>
      <div class="card-body">
        <form method="post" action="/admin/shops/{{ shop.id }}/tx/sale" class="row g-2">
          <div class="col-6"><input class="form-control" type="number" step="0.01" name="amount" placeholder="Summasi (so'm)" required></div>
          <div class="col-6"><input class="form-control" type="text" name="note" placeholder="Izoh (ixtiyoriy)"></div>
          <div class="col-12"><button class="btn btn-primary">Qo'shish</button></div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">To'lov qabul qilish (payment)</div>
      <div class="card-body">
        <form method="post" action="/admin/shops/{{ shop.id }}/tx/payment" class="row g-2">
          <div class="col-6"><input class="form-control" type="number" step="0.01" name="amount" placeholder="Summasi (so'm)" required></div>
          <div class="col-6"><input class="form-control" type="text" name="note" placeholder="Izoh (ixtiyoriy)"></div>
          <div class="col-12"><button class="btn btn-success">Qabul qilish</button></div>
        </form>
      </div>
    </div>
  </div>
</div>

<table class="table table-sm table-striped align-middle">
  <thead><tr><th>Sana</th><th>Turi</th><th>Summa</th><th>Izoh</th></tr></thead>
  <tbody>
    {% for t in txs %}
    <tr>
      <td>{{ t.created_at.strftime('%Y-%m-%d %H:%M') if t.created_at else '' }}</td>
      <td>
        {% if t.kind.value == 'sale' %}
        <span class="badge bg-warning text-dark">sale</span>
        {% else %}
        <span class="badge bg-success">payment</span>
        {% endif %}
      </td>
      <td>{{ '%.0f'|format(t.amount) }}</td>
      <td>{{ t.note or '-' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
